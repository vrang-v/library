> 우리 모두를 합친 것보다 더 현명한 사람은 없다.

4.&nbsp;역할, 책임, 협력
===

## 협력
협력은 다른 객체에게 도움을 **요청**할 때 시작된다. 

요청을 받은 객체도 문제를 해결하기 위해 다른 객체에게 도움을 요청한다.

*결과적으로 협력은 다수의 요청과 응답으로 구성되며, 전체적으로 협력은 **연쇄적인 요청과 응답의 흐름**으로 구성된다.*

    - 왕이 토끼에게 증인을 부를 것을 '요청'한다.

    - 왕의 요청을 받은 토끼는 모자 장수에게 증인석으로 입장할 것을 '요청'한다.

    - 모자 장수는 증인석에 입장함으로써 토끼의 요청에 '응답'한다.

    - 모자 장수의 입장은 왕이 토끼에게 요청했던 증인 호출에 대한 '응답'이기도 하다.

    - 왕은 모자 장수에게 증언할 것을 '요청'한다.

    - 모자 장수는 증언을 함으로써 왕의 요청에 '응답'한다.

위 이야기에서 *왕, 토끼, 모자 장수* 는 다른 객체와 협력을 통해 문제를 해결해나가고 있다.

객체사이의 협력은 요청을 보내고 응답을 하는 과정으로 이루어진다.

이 때, 각 객체가 다른 객체에게 요청을 보내는 이유는 그들이 요청을 보낼 의무를 갖고 있기 때문이다.

 요청을 받아들이는 이유는 응답에 필요한 정보를 가지고 있기 때문이다.

그렇기에 요청과 응답은 협력에 참여하는 객체가 수행할 책임을 정의한다.
## 책임
객체지향에서 객체가 적절한 행동을 해야 하거나, 다른 객체의 요청에 응답할 수 있어야 하는 것을 **책임**을 갖는다고 한다.

책임은 객체지향에서 품질을 결정하는 가장 중요한 재료이다.

객체지향에서 가장 중요한 능력은 책임을 올바른 객체에게 할당하는 것이다.

객체의 책임은 객체의 외부에 제공해줄 수 있는 정보와 서비스의 목록이다.

따라서, 책임은 외부에서 접근하는 **공용 인터페이스**를 구성하며 이는 **캡슐화**로도 이어진다.
### 책임의 분류
크레이그 라만은 객체의 책임을 아래 두 가지 범주소 분류하고 있다.
- 하는 것 (doing)

    - 객체를 생성하거나 계산을 하는 등의 스스로 하는것
    - 다른 객체의 행동을 시작시키는 것
    - 다른 객체의 활동을 제어하고 조절하는 것
    

- 아는 것 (knowing)
    
    - 개인적인 정보에 관해 아는 것
    - 관련된 객체에 관해 아는 것
    - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
    
## 역할
역할은 책임의 집합이다. 왜 책임을 따로 묶어 관리하는 것일까?

*그것은 역할이 **재사용** 가능하고 유여한 객체지향 설계를 하기위한 매우 중요한 구성요소이기 때문이다.*

역할은 협력 내에서 다른 객체로 **대체**할 수 있음을 나타낸다.

    - '여왕'은 '앨리스'에게 증언할 것을 요청한다.

    - '앨리스'는 증언을 함으로써 '여왕'의 요청에 응답한다.

아까의 재판 이야기에서 등장인물이 바뀐다면 협력관계는 *왕 - 토끼 - 모자 장수* 에서 *여왕 - 토끼 - 앨리스* 로 바뀌게 된다.

두 개의 협력관계는 등장 인물을 제외하고 너무나도 유사하기 때무에 하나의 협력으로 다루고 싶다.

이 떄 생각해야 할 것이 역할이다.

왕과 여왕은 모두 *판사* 의 역할을 모자 장수와 앨리스는 모두 *증인* 의 역할을 수행한다.

등장인물의 협력을 *판사 - 토끼 - 증인* 의 관계로 바라보면 하나의 관계로 표현할 수 있다.

역할은 **"이 자리는 해당 역할을 수행할 수 있는 어떤 객체라도 대신할 수 있습니다"** 라고 말하는 것과 같다.

### 어떤 객체라도 역할을 대신할 수 있는 것은 아니다
역할을 수행하기 위해서는 각 역할이 수신할 수 있는 메시지에 대해 동일하게 이해해야한다.

즉, 역할을 수행하기 위해서 행동이 호환되어야 한다.

### 객체가 주어진 역할만을 수행하는 것은 아니다
객체는 주어진 역할과 책임 외에도 다른 책임을 수행할 수 있고, 여러 역할을 맡을 수도 있다.

그러나, 객체는 주어진 역할에 대해서는 모든 책임을 다른 객체와 동일하게 수행할 수 있어야 한다.

> 역할의 대체 가능성은 행위 호환성을 의미한다. 행위 호환성은 동일한 책임의 수행을 의미한다.

## 객체지향 설계 기법

### 1. 책임 주도 설계 ( RDD : Responsibility-Driven Design )
 채임 주도 설계는 시스템의 책임을 더 작은 객체의 책임으로 변환하고, 각 객체가 책임을 수행하는 중에  

필요한 정보나 서비스를 제공해줄 협력자를 찾아 해당 협력자에게 책임을 할당하는 방식으로 협력 공동체를 구축하는 방식이다.

책임 주도 설계를 하는 절차는 아래와 같이 요약할 수 있다.

1. 시스템이 사용자에게 제공해야 하는 기능인 시스템책임을 파악한다.


2. 시스템 책임을 더 작은 책임으로 분할한다.


3. 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.


4. 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
   

5. 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.
### 2. 디자인 패턴
디자인 패턴은 공통으로 사용할 수 있는 역할, 책임 , 협력의 템플릿이다.

상황에 적용할 수 있는 디자인 패턴을 알고 있다면 책임-주도 설계의 절차를 순차적으로 따르지 않고도  

객체들의 역할, 책임, 협력 관계를 빠르고 쉽게 만들어낼 수 있다.

### 3. 테스트 주도 개발 ( TDD : Test-Driven Development )
테스트-주도 개발의 기본 흐름은 실패하는 테스트를 작성하고, 테스트를 통과하는 가장 간단한 코드를 작성한 후  리팩토링을 통해 중복을 제거하는 개발 방법이다.